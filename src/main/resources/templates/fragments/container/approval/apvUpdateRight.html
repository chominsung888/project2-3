<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div class="right" th:fragment="apvUpdateRightFragment">
    <div class="right-con">
        <div class="top">
            <div class="gnb">
                <ul>
                    <th:block sec:authorize="isAnonymous()">
                        <li><a th:href="@{/member/login}">로그인</a></li>
                        <li><a th:href="@{/member/Join}">회원가입</a></li>
                    </th:block>
                    <th:block sec:authorize="isAuthenticated()">
                        로그인중
                    </th:block>
                </ul>
            </div>
        </div>
        <div class="bottom">
            <div class="apv-data">
                <div class="container">
                    <div class="write">
                        <div class="write-con">
                            <form th:action="@{/apv/apvUpdate}" method="POST" enctype="multipart/form-data">
                                <h1>보고서 수정하기</h1>
                                <table>
                                    <thead>
                                    <input type="hidden" name="id" id="id" th:value="${approvalDto.id}">
                                    <input type="hidden" name="memberId" id="memberId"
                                           th:value="${approvalDto.memberEntity.id}">
                                    <tr>
                                        <th class="tg-0pky" rowspan="2">결재자</th>
                                        <th class="tg-0pky">부서</th>
                                        <th class="tg-0pky">부서값</th>
                                        <th class="tg-0pky" rowspan="2">문서종류</th>
                                        <th class="tg-0pky" rowspan="2">
                                            <select class="select_type01 w170" th:name="approvalDivEntity"
                                                    id="approvalDivEntity">
                                                <option th:each="apvDiv : ${approvalDivDtoList}"
                                                        th:value="${apvDiv?.id}"
                                                        th:utext="${apvDiv?.apvDivName}"
                                                        th:selected="${apvDiv.apvDivName eq approvalDto.approvalDivEntity.apvDivName}"></option>
                                            </select>
                                            <input type="hidden" id="approvalDivEntityId" name="approvalDivEntity"
                                                   th:value="${approvalDto.approvalDivEntity.id}"></th>
                                    </tr>
                                    <tr>
                                        <th class="tg-0pky">이름</th>
                                        <th class="tg-0pky">직급 값+  <select class="apvFnl" th:name="apvFnl" id="apvFnl">
                                            <option th:each="member : ${memberDtoList}"
                                                    th:value="${member?.name}"
                                                    th:utext="${member?.name}"
                                                    th:selected="${member.name eq approvalDto.apvFnl}"></option>
                                        </select></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="tg-0pky">작성자</td>
                                        <td class="tg-0pky">부서 값</td>
                                        <td class="tg-0pky">직급 값 + <input type="text" name="memberName" id="memberName"
                                                                          th:value="${approvalDto.memberEntity.name}"
                                                                          readonly></td>
                                        <td class="tg-0pky">결재 기한</td>
                                        <td class="tg-0pky"><input type="date" name="date" id="date" max="2099-12-31"
                                                                   min="2020-01-01" value="2024-05-31" th:value="${approvalDto.date}"></td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0pky">제목</td>
                                        <td class="tg-0pky" colspan="4"><input type="text" name="apvTitle" id="apvTitle"
                                                                               th:value="${approvalDto.apvTitle}"></td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0pky" colspan="5">내용
                                            <textarea name="apvContent" id="apvContent"
                                                      cols="50" rows="30">[[${approvalDto.apvContent}]]</textarea>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0pky">파일</td>
                                        <td class="tg-0pky" colspan="2"><input type="file" name="apvFile" id="apvFile"
                                                                               th:text="${approvalDto.apvOldFileName}"
                                                                               readonly>
                                            <input type="hidden" name="apvFile" value="<%=file_path %>"></td>
                                        <td class="tg-0pky" colspan="2">파일 다운로드</td>
                                    </tr>



                                    <!--↓자기가 결재자가 아닐 때-->
                                    <th:block th:unless="${approvalDto.apvFnl==myUserDetails.name}">
                                        <tr>
                                            <td class="tg-0pky" colspan="5">코멘트 내용
                                                <textarea name="apvCom" cols="40" rows="10"
                                                          placeholder="내용이 없습니다." readonly>[[${approvalDto.apvCom}]]</textarea></td>
                                        </tr>
                                        <tr>
                                            <td class="tg-0pky">상태</td>
                                            <td class="tg-0pky"><input type="text" name="apvStatus" id="apvStatus" th:value="${approvalDto.approvalStatusEntity.apvStatus}" readonly></td>
                                            <td class="tg-0pky"></td>
                                            <td class="tg-0pky"></td>
                                            <td class="tg-0pky"></td>
                                        </tr>
                                        <input type="hidden" th:value="${approvalDto.approvalStatusEntity.id}" id="approvalStatusEntity"
                                               name="approvalStatusEntity">
                                        <tr>
                                            <td class="tg-0lax"></td>
                                            <td class="tg-0lax"></td>
                                            <td class="tg-0lax"><input type="button" value="취소"
                                                                       onclick="history.back();"/></td>
                                            <td class="tg-0lax"><input type="submit" value="수정"></td>
                                            <td class="tg-0lax"><a
                                                th:href="@{/apv/apvDelete/{id}(id=${approvalDto.id})}" onclick="return confirm('정말 삭제 하시겠습니까?')">삭제</a></td>
                                        </tr>
                                    </th:block>

                                    </tbody>
                                </table>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>

</html>









